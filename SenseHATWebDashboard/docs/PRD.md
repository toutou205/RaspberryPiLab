# Product Requirement Document (PRD)

## 1. 项目概述
构建一个基于 Raspberry Pi Sense HAT 的实时 Web 仪表盘，支持姿态可视化、环境监测、LED 矩阵互动控制，以及“黑匣子”数据记录功能。

## 2. 用户故事
- **实时监控**: 用户希望在浏览器上看到延迟低于 100ms 的姿态（3D角度）和环境数据。
- **高度感知**: 用户希望看到基于气压换算的近似海拔高度（Altitude）。
- **互动控制**: 用户可以通过物理摇杆切换 LED 模式，或在网页上查看当前模式状态。
- **黑匣子记录**: 用户可以在网页上开启/关闭“录制模式”。开启时，所有传感器数据、操作事件均被写入 CSV 文件，便于事后分析。

## 3. 功能需求
### 3.1 核心功能
- **数据采集**: 20Hz 频率读取 IMU (Pitch/Roll/Yaw) 和 环境 (Temp/Hum/Press)。
- **数据计算**: 新增算法，将气压 (hPa) 转换为海拔高度 (Meters)。
- **LED 控制**: 保留原有的 Monitor, Spirit Level, Rainbow, Fire 四种模式。
- **摇杆交互**: 保留原有的模式切换、亮度调节、总开关功能。

### 3.2 新增功能 (重点)
- **数据记录器 (Logger)**:
    - 格式: CSV 文件。
    - 命名: `logs/sensor_log_YYYYMMDD_HHMMSS.csv`.
    - 触发: 网页端增加“开始/停止录制”按钮。
    - 内容: 时间戳, 温度, 湿度, 气压, 高度, Pitch, Roll, Yaw, 当前模式, Joystick事件。

## 4. 非功能需求
- **稳定性**: 网络断开后自动重连。
- **健壮性**: 传感器读取失败不应卡死主线程。